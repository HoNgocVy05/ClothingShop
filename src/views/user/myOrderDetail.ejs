<div class="user-page">
<%- include("../partials/userSidebar", { activePage: activePage }) %>

<div class="sidebar-content">
    <div id="my-order-detail">
        <!-- Trạng thái đơn hàng -->
        <div class="order-status detail">
            <p><%= order.status %></p>
            <p>Dự kiến giao hàng vào <span style="color: green"><%= order.delivery_from %> - <%= order.delivery_to %></span></p>
        </div>

        <!-- Thông tin địa chỉ -->
        <div class="order-address">
            <i class="fa-solid fa-location-dot"></i>
            <p><%= order.user_name %></p>
            <p><%= order.phone %></p>
            <p><%= order.address %></p>
        </div>

        <!-- Danh sách sản phẩm trong đơn -->
        <div class="my-order">
            <div class="order-item">
                <div class="order-products-detail">
                    <% order.items.forEach(item => { %>
                        <div class="order-product">
                            <img src="<%= item.image ? '/uploads/products/' + item.image : '/images/img-product-default.png' %>" alt="<%= item.name %>">
                            <div class="order-product-info">
                                <p class="order-product-name"><%= item.name %></p>
                                <p class="order-product-size"><%= item.size %></p>
                                <div class="price-row">
                                    <p>x<%= item.quantity %></p>
                                    <p><%= (item.price * item.quantity).toLocaleString() %>đ</p>
                                </div>
                            </div>
                        </div>
                    <% }) %>
                </div>
            </div>
        </div>

        <!-- Tổng quan đơn hàng -->
        <div class="detail checkout-summary">
            <p>Tổng quan đơn hàng</p>
            <div class="sum-row"><span>Tổng phụ</span> <%= order.subtotal.toLocaleString() %>đ</div>
            <div class="sum-row"><span>Vận chuyển</span> <span><%= order.shipping_fee.toLocaleString() %>đ</span></div>
            <div class="sum-total"><span>Tổng</span> <strong><%= order.total.toLocaleString() %>đ</strong></div>
        </div>

        <!-- Chi tiết đơn hàng -->
        <div class="order-info">
            <p>Chi tiết đơn hàng</p>
            <div class="sum-row">
                <span>Mã đơn hàng</span>
                <span class="order-code"><%= order.code %> <i class="fa-regular fa-copy"></i></span>
                <p id="copy-notice">Đã sao chép</p>
            </div>
            <div class="sum-row">
                <span>Ngày đặt hàng</span> 
                <%= new Date(order.created_at).toLocaleDateString('vi-VN', { weekday: 'long', day: '2-digit', month: 'long', year: 'numeric' }) %> 
                <%= new Date(order.created_at).toLocaleTimeString('vi-VN', { hour: '2-digit', minute: '2-digit' }) %>
            </div>
            <div class="sum-row"><span>Phương thức thanh toán</span> <%= order.payment_method %></div>
        </div>
    </div>
</div>
