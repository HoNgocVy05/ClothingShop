<div class="user-page">
    <!-- Sidebar người dùng -->
    <%- include("../partials/userSidebar", { activePage: locals.activePage }) %>

    <div class="sidebar-content">
        <div class="change-password-box">
            <h2>ĐỔI MẬT KHẨU <i class="fa-solid fa-lock"></i></h2>

            <!-- Hiển thị thông báo lỗi / thành công -->
            <% if (error) { %>
                <div class="alert-error-custom"><%= error %></div>
            <% } %>
            <% if (message) { %>
                <div class="alert-success-custom"><%= message %></div>
            <% } %>

            <!-- Form đổi mật khẩu -->
            <form method="POST" action="/change-password" class="cp-form">

                <div class="cp-field">
                    <label>Mật khẩu hiện tại</label>
                    <div class="cp-input-wrapper">
                        <input type="password" id="current-pass" name="currentPassword" required>
                        <span class="toggle-password" onclick="togglePass('current-pass', this)">
                            <i class="fas fa-eye"></i>
                        </span>
                    </div>
                </div>

                <div class="cp-field">
                    <label>Mật khẩu mới</label>
                    <div class="cp-input-wrapper">
                        <input type="password" id="new-pass" name="newPassword" required>
                        <span class="toggle-password" onclick="togglePass('new-pass', this)">
                            <i class="fas fa-eye"></i>
                        </span>
                    </div>
                </div>

                <div class="cp-field">
                    <label>Xác nhận mật khẩu mới</label>
                    <div class="cp-input-wrapper">
                        <input type="password" id="confirm-pass" name="confirmPassword" required>
                        <span class="toggle-password" onclick="togglePass('confirm-pass', this)">
                            <i class="fas fa-eye"></i>
                        </span>
                    </div>
                </div>

                <button type="submit" class="cp-submit">Đổi mật khẩu</button>
            </form>
        </div>
    </div>
</div>

<script>
// Toggle show/hide password
function togglePass(inputId, icon) {
    const input = document.getElementById(inputId);
    if (input.type === "password") {
        input.type = "text";
        icon.querySelector("i").classList.remove("fa-eye");
        icon.querySelector("i").classList.add("fa-eye-slash");
    } else {
        input.type = "password";
        icon.querySelector("i").classList.remove("fa-eye-slash");
        icon.querySelector("i").classList.add("fa-eye");
    }
}
</script>