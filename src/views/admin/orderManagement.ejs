<div class="dashboard">
    <!-- Thanh tìm kiếm -->
    <div class="admin search-container">
        <form action="/admin/order-management" method="GET">
            <input type="search" name="q" class="search-box" placeholder="Tìm kiếm mã đơn hàng..." value="<%= q || '' %>">
            <button type="submit" class="search-btn"><i class="fa fa-search"></i></button>
        </form>
    </div>

    <!-- Thống kê đơn hàng theo trạng thái -->
    <div class="statistical-overview">
        <div class="overview-box">
            <div class="overview-info">
                <p >Chờ xác nhận</p>
                <p><%= orders.filter(o => o.status === 'Chờ xác nhận').length %></p>
            </div>
        </div>
        <div class="overview-box">
            <div class="overview-info">
                <p>Chờ lấy hàng</p>
                <p><%= orders.filter(o => o.status === 'Chờ lấy hàng').length %></p>
            </div>
        </div>
        <div class="overview-box">
            <div class="overview-info">
                <p>Đang giao hàng</p>
                <p><%= orders.filter(o => o.status === 'Đang giao hàng').length %></p>
            </div>
        </div>
        <div class="overview-box">
            <div class="overview-info">
                <p>Đã giao</p>
                <p><%= orders.filter(o => o.status === 'Đã giao').length %></p>
            </div>
        </div>
    </div>

    <!-- Bảng danh sách đơn hàng -->
    <div class="statistical-best-seller statistical-time">
        <div class="admin-table order-management-table">
            <table>
                <thead>
                    <tr class="table-col">
                        <th><input type="checkbox"></th>
                        <th>Ngày đặt</th>
                        <th>Mã đơn hàng</th>
                        <th>Khách hàng</th>
                        <th>Sản phẩm</th>
                        <th>Thành tiền</th>
                        <th>Thanh toán</th>
                        <th>Trạng thái</th>
                    </tr>
                </thead>
                <tbody>
                    <% orders.forEach(order => { %>
                        <tr class="order-row sidebarItem" onclick="window.location='/admin/order/<%= order.id %>'" style="cursor:pointer" onItem="true">
                            <td><input type="checkbox"></td>
                            <td><%= new Date(order.created_at).toLocaleDateString('vi-VN') %></td>
                            <td><%= order.order_code %></td>
                            <td><%= order.user_name %></td>
                            <td>
                                <% order.products.forEach(item => { %>
                                    <div><%= item.name %> x<%= item.quantity %></div>
                                <% }) %>
                            </td>
                            <td><%= order.total_price.toLocaleString() %>đ</td>
                            <td><%= order.payment_method %></td>
                            <td>
                                <span class="order-status 
                                    <%= order.status === 'Chờ xác nhận' ? 'status-pending' :
                                        order.status === 'Đã hủy' ? 'status-cancelled' :
                                        order.status === 'Đã giao' ? 'status-received' :
                                        'status-success' %>">
                                    <%= order.status %>
                                </span>
                            </td>   
                        </tr>
                    <% }) %>
                </tbody>
            </table>
        </div>
    </div>
</div>
